<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Student Performance – Faculty Console</title><link rel="stylesheet" href="../styles.css"/>
<style>:root{--bg1:#0b1220;--bg2:#0a1b2e}body{margin:0;background:linear-gradient(180deg,var(--bg2),var(--bg1));color:#e7e9f3}.wrap{width:min(1160px,96%);margin:0 auto 40px}.nav{position:fixed;top:0;left:0;right:0;background:linear-gradient(180deg, rgba(10,20,40,.95), rgba(10,20,40,.85));border-bottom:1px solid rgba(148,163,184,.2);backdrop-filter:blur(10px);z-index:10}.nav-inner{max-width:1160px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;justify-content:space-between}main{padding-top:76px}.card{border:1px solid rgba(148,163,184,.28);border-radius:18px;padding:18px;background:linear-gradient(180deg, rgba(2,6,23,.86), rgba(2,6,23,.72));backdrop-filter:blur(12px);box-shadow:0 24px 60px rgba(2,6,23,.55)}.form-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px 14px}.form-grid .field input,.form-grid .field select{border-radius:12px;border:1px solid rgba(148,163,184,.35);background:rgba(15,23,42,.96);padding:10px 12px;width:100%}.data-table{width:100%;border-collapse:separate;border-spacing:0 6px}.data-table thead th{font-weight:600;color:#cbd5f5;font-size:12px;padding:8px 10px;border-bottom:1px solid rgba(148,163,184,.25)}.data-table tbody td{font-size:12px;color:#e5e7eb;padding:8px 10px;background:rgba(2,6,23,.45)}</style></head>
<body><header class="nav"><div class="nav-inner"><div class="nav-left"><strong>Heema Institute of Technology</strong><div class="nav-sub">Faculty Console</div></div><div class="nav-right"><a class="btn btn-outline" href="dashboard.html">← Back to Dashboard</a><button class="btn btn-outline" onclick="Auth.logout()">Logout</button></div></div></header>
<main class="wrap">
<section class="card" style="margin-top:14px"><h2 style="margin:0 0 6px">Student Performance</h2><div class="form-grid" style="margin-top:12px"><div class="field"><label>Class</label><select id="cls"></select></div><div class="field"><label>Course</label><select id="crs"></select></div><div class="field"><button class="btn btn-primary" id="load" type="button">Analyze</button></div></div></section>
<section class="card" style="margin-top:16px"><table class="data-table" id="tbl"><thead><tr><th align="left">Student</th><th align="left">Average</th><th align="left">Status</th></tr></thead><tbody></tbody></table></section>
</main>
<script>const API='https://college-management-system-s2yf.onrender.com'; const fid=sessionStorage.getItem('auth_user_id')||''; if((sessionStorage.getItem('auth_role')||'')!=='faculty'){window.location.href='../login.html'}
async function base(){ const r=await fetch(API+'/api/faculty/me',{headers:{'X-Faculty-Id':fid}}); const d=await r.json(); const classes=(d.faculty?.classes||[]), courses=(d.faculty?.courses||[]); document.getElementById('cls').innerHTML=classes.map(c=>`<option value="${c.id}">${c.name}</option>`).join(''); document.getElementById('crs').innerHTML=courses.map(c=>`<option value="${c.id}">${c.code||''} ${c.name||''}</option>`).join(''); }
async function load(){ const cls=Number(document.getElementById('cls').value); const crs=Number(document.getElementById('crs').value); if(!cls||!crs){ alert('Select class and course'); return; } const r=await fetch(API+`/api/faculty/performance?class_id=${cls}&course_id=${crs}`,{headers:{'X-Faculty-Id':fid}}); const d=await r.json(); const tbody=document.querySelector('#tbl tbody'); const items=d.items||[]; if(!r.ok){ tbody.innerHTML=`<tr><td colspan="3" style="color:#ef4444">${d.error||'Failed'}</td></tr>`; return;} if(!items.length){ tbody.innerHTML=`<tr><td colspan="3" style="color:#9fb0c5">No data</td></tr>`; return;} tbody.innerHTML=items.map(x=>`<tr><td>${x.student_name}</td><td>${x.average??'-'}</td><td>${(x.average??0)>=50?'OK':'Low'}</td></tr>`).join(''); }
document.getElementById('load').addEventListener('click', load);
(async()=>{await base()})();</script>
</body></html>
